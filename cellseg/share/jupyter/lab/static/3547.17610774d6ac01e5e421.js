"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[3547],{43547:(e,t,n)=>{n.r(t);n.d(t,{blockComment:()=>d,blockUncomment:()=>m,copyLineDown:()=>Ut,copyLineUp:()=>Rt,cursorCharBackward:()=>ae,cursorCharForward:()=>le,cursorCharLeft:()=>oe,cursorCharRight:()=>se,cursorDocEnd:()=>ct,cursorDocStart:()=>it,cursorGroupBackward:()=>he,cursorGroupForward:()=>fe,cursorGroupLeft:()=>ce,cursorGroupRight:()=>ue,cursorLineBoundaryBackward:()=>be,cursorLineBoundaryForward:()=>Le,cursorLineDown:()=>De,cursorLineEnd:()=>Ee,cursorLineStart:()=>Oe,cursorLineUp:()=>Se,cursorMatchingBracket:()=>Re,cursorPageDown:()=>xe,cursorPageUp:()=>Te,cursorSubwordBackward:()=>ge,cursorSubwordForward:()=>pe,cursorSyntaxLeft:()=>we,cursorSyntaxRight:()=>Ae,defaultKeymap:()=>_t,deleteCharBackward:()=>wt,deleteCharForward:()=>At,deleteGroupBackward:()=>St,deleteGroupForward:()=>Dt,deleteLine:()=>It,deleteToLineEnd:()=>Ct,deleteToLineStart:()=>Bt,deleteTrailingWhitespace:()=>Tt,emacsStyleKeymap:()=>$t,history:()=>M,historyField:()=>L,historyKeymap:()=>Q,indentLess:()=>qt,indentMore:()=>Ht,indentSelection:()=>zt,indentWithTab:()=>Yt,insertBlankLine:()=>Jt,insertNewline:()=>Nt,insertNewlineAndIndent:()=>Vt,insertTab:()=>Wt,invertedEffects:()=>C,isolateHistory:()=>D,lineComment:()=>u,lineUncomment:()=>f,moveLineDown:()=>Et,moveLineUp:()=>Ot,redo:()=>E,redoDepth:()=>N,redoSelection:()=>R,selectAll:()=>ht,selectCharBackward:()=>Fe,selectCharForward:()=>Je,selectCharLeft:()=>Ge,selectCharRight:()=>Ve,selectDocEnd:()=>ft,selectDocStart:()=>ut,selectGroupBackward:()=>We,selectGroupForward:()=>qe,selectGroupLeft:()=>ze,selectGroupRight:()=>He,selectLine:()=>dt,selectLineBoundaryBackward:()=>st,selectLineBoundaryForward:()=>ot,selectLineDown:()=>et,selectLineEnd:()=>at,selectLineStart:()=>lt,selectLineUp:()=>Ze,selectMatchingBracket:()=>Ue,selectPageDown:()=>rt,selectPageUp:()=>nt,selectParentSyntax:()=>mt,selectSubwordBackward:()=>_e,selectSubwordForward:()=>Ke,selectSyntaxLeft:()=>Ye,selectSyntaxRight:()=>Qe,simplifySelection:()=>pt,splitLine:()=>xt,standardKeymap:()=>Kt,toggleBlockComment:()=>h,toggleBlockCommentByLine:()=>p,toggleComment:()=>a,toggleLineComment:()=>c,transposeChars:()=>Mt,undo:()=>O,undoDepth:()=>I,undoSelection:()=>j});var r=n(74405);var o=n(54986);var s=n(16888);var l=n(72104);const a=e=>{let t=g(e.state);return t.line?c(e):t.block?p(e):false};function i(e,t){return({state:n,dispatch:r})=>{if(n.readOnly)return false;let o=e(t,n);if(!o)return false;r(n.update(o));return true}}const c=i(v,0);const u=i(v,1);const f=i(v,2);const h=i(A,0);const d=i(A,1);const m=i(A,2);const p=i(((e,t)=>A(e,t,w(t))),0);function g(e,t=e.selection.main.head){let n=e.languageDataAt("commentTokens",t);return n.length?n[0]:{}}const y=50;function k(e,{open:t,close:n},r,o){let s=e.sliceDoc(r-y,r);let l=e.sliceDoc(o,o+y);let a=/\s*$/.exec(s)[0].length,i=/^\s*/.exec(l)[0].length;let c=s.length-a;if(s.slice(c-t.length,c)==t&&l.slice(i,i+n.length)==n){return{open:{pos:r-a,margin:a&&1},close:{pos:o+i,margin:i&&1}}}let u,f;if(o-r<=2*y){u=f=e.sliceDoc(r,o)}else{u=e.sliceDoc(r,r+y);f=e.sliceDoc(o-y,o)}let h=/^\s*/.exec(u)[0].length,d=/\s*$/.exec(f)[0].length;let m=f.length-d-n.length;if(u.slice(h,h+t.length)==t&&f.slice(m,m+n.length)==n){return{open:{pos:r+h+t.length,margin:/\s/.test(u.charAt(h+t.length))?1:0},close:{pos:o-d-n.length,margin:/\s/.test(f.charAt(m-1))?1:0}}}return null}function w(e){let t=[];for(let n of e.selection.ranges){let r=e.doc.lineAt(n.from);let o=n.to<=r.to?r:e.doc.lineAt(n.to);let s=t.length-1;if(s>=0&&t[s].to>r.from)t[s].to=o.to;else t.push({from:r.from,to:o.to})}return t}function A(e,t,n=t.selection.ranges){let r=n.map((e=>g(t,e.from).block));if(!r.every((e=>e)))return null;let o=n.map(((e,n)=>k(t,r[n],e.from,e.to)));if(e!=2&&!o.every((e=>e))){return{changes:t.changes(n.map(((e,t)=>{if(o[t])return[];return[{from:e.from,insert:r[t].open+" "},{from:e.to,insert:" "+r[t].close}]})))}}else if(e!=1&&o.some((e=>e))){let e=[];for(let t=0,n;t<o.length;t++)if(n=o[t]){let o=r[t],{open:s,close:l}=n;e.push({from:s.pos-o.open.length,to:s.pos+s.margin},{from:l.pos-l.margin,to:l.pos+o.close.length})}return{changes:e}}return null}function v(e,t,n=t.selection.ranges){let r=[];let o=-1;for(let{from:s,to:l}of n){let e=r.length,n=1e9;for(let a=s;a<=l;){let e=t.doc.lineAt(a);if(e.from>o&&(s==l||l>e.from)){o=e.from;let s=g(t,a).line;if(!s)continue;let l=/^\s*/.exec(e.text)[0].length;let i=l==e.length;let c=e.text.slice(l,l+s.length)==s?l:-1;if(l<e.text.length&&l<n)n=l;r.push({line:e,comment:c,token:s,indent:l,empty:i,single:false})}a=e.to+1}if(n<1e9)for(let t=e;t<r.length;t++)if(r[t].indent<r[t].line.text.length)r[t].indent=n;if(r.length==e+1)r[e].single=true}if(e!=2&&r.some((e=>e.comment<0&&(!e.empty||e.single)))){let e=[];for(let{line:t,token:o,indent:s,empty:l,single:a}of r)if(a||!l)e.push({from:t.from+s,insert:o+" "});let n=t.changes(e);return{changes:n,selection:t.selection.map(n,1)}}else if(e!=1&&r.some((e=>e.comment>=0))){let e=[];for(let{line:t,comment:n,token:o}of r)if(n>=0){let r=t.from+n,s=r+o.length;if(t.text[s-t.from]==" ")s++;e.push({from:r,to:s})}return{changes:e}}return null}const S=r.q6.define();const D=r.q6.define();const C=r.r$.define();const B=r.r$.define({combine(e){return(0,r.BO)(e,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})}});function T(e){let t=0;e.iterChangedRanges(((e,n)=>t=n));return t}const x=r.QQ.define({create(){return Y.empty},update(e,t){let n=t.state.facet(B);let o=t.annotation(S);if(o){let s=t.docChanged?r.jT.single(T(t.changes)):undefined;let l=G.fromTransaction(t,s),a=o.side;let i=a==0?e.undone:e.done;if(l)i=V(i,i.length,n.minDepth,l);else i=q(i,t.startState.selection);return new Y(a==0?o.rest:i,a==0?i:o.rest)}let s=t.annotation(D);if(s=="full"||s=="before")e=e.isolate();if(t.annotation(r.YW.addToHistory)===false)return!t.changes.empty?e.addMapping(t.changes.desc):e;let l=G.fromTransaction(t);let a=t.annotation(r.YW.time),i=t.annotation(r.YW.userEvent);if(l)e=e.addChanges(l,a,i,n.newGroupDelay,n.minDepth);else if(t.selection)e=e.addSelection(t.startState.selection,a,i,n.newGroupDelay);if(s=="full"||s=="after")e=e.isolate();return e},toJSON(e){return{done:e.done.map((e=>e.toJSON())),undone:e.undone.map((e=>e.toJSON()))}},fromJSON(e){return new Y(e.done.map(G.fromJSON),e.undone.map(G.fromJSON))}});function M(e={}){return[x,B.of(e),o.tk.domEventHandlers({beforeinput(e,t){let n=e.inputType=="historyUndo"?O:e.inputType=="historyRedo"?E:null;if(!n)return false;e.preventDefault();return n(t)}})]}const L=x;function b(e,t){return function({state:n,dispatch:r}){if(!t&&n.readOnly)return false;let o=n.field(x,false);if(!o)return false;let s=o.pop(e,n,t);if(!s)return false;r(s);return true}}const O=b(0,false);const E=b(1,false);const j=b(0,true);const R=b(1,true);function U(e){return function(t){let n=t.field(x,false);if(!n)return 0;let r=e==0?n.done:n.undone;return r.length-(r.length&&!r[0].changes?1:0)}}const I=U(0);const N=U(1);class G{constructor(e,t,n,r,o){this.changes=e;this.effects=t;this.mapped=n;this.startSelection=r;this.selectionsAfter=o}setSelAfter(e){return new G(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map((e=>e.toJSON()))}}static fromJSON(e){return new G(e.changes&&r.as.fromJSON(e.changes),[],e.mapped&&r.n0.fromJSON(e.mapped),e.startSelection&&r.jT.fromJSON(e.startSelection),e.selectionsAfter.map(r.jT.fromJSON))}static fromTransaction(e,t){let n=z;for(let r of e.startState.facet(C)){let t=r(e);if(t.length)n=n.concat(t)}if(!n.length&&e.changes.empty)return null;return new G(e.changes.invert(e.startState.doc),n,undefined,t||e.startState.selection,z)}static selection(e){return new G(undefined,z,undefined,undefined,e)}}function V(e,t,n,r){let o=t+1>n+20?t-n-1:0;let s=e.slice(o,t);s.push(r);return s}function J(e,t){let n=[],r=false;e.iterChangedRanges(((e,t)=>n.push(e,t)));t.iterChangedRanges(((e,t,o,s)=>{for(let l=0;l<n.length;){let e=n[l++],t=n[l++];if(s>=e&&o<=t)r=true}}));return r}function F(e,t){return e.ranges.length==t.ranges.length&&e.ranges.filter(((e,n)=>e.empty!=t.ranges[n].empty)).length===0}function P(e,t){return!e.length?t:!t.length?e:e.concat(t)}const z=[];const H=200;function q(e,t){if(!e.length){return[G.selection([t])]}else{let n=e[e.length-1];let r=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-H));if(r.length&&r[r.length-1].eq(t))return e;r.push(t);return V(e,e.length-1,1e9,n.setSelAfter(r))}}function W(e){let t=e[e.length-1];let n=e.slice();n[e.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1));return n}function $(e,t){if(!e.length)return e;let n=e.length,r=z;while(n){let o=K(e[n-1],t,r);if(o.changes&&!o.changes.empty||o.effects.length){let t=e.slice(0,n);t[n-1]=o;return t}else{t=o.mapped;n--;r=o.selectionsAfter}}return r.length?[G.selection(r)]:z}function K(e,t,n){let o=P(e.selectionsAfter.length?e.selectionsAfter.map((e=>e.map(t))):z,n);if(!e.changes)return G.selection(o);let s=e.changes.map(t),l=t.mapDesc(e.changes,true);let a=e.mapped?e.mapped.composeDesc(l):l;return new G(s,r.Py.mapEffects(e.effects,t),a,e.startSelection.map(l),o)}const _=/^(input\.type|delete)($|\.)/;class Y{constructor(e,t,n=0,r=undefined){this.done=e;this.undone=t;this.prevTime=n;this.prevUserEvent=r}isolate(){return this.prevTime?new Y(this.done,this.undone):this}addChanges(e,t,n,r,o){let s=this.done,l=s[s.length-1];if(l&&l.changes&&!l.changes.empty&&e.changes&&(!n||_.test(n))&&(!l.selectionsAfter.length&&t-this.prevTime<r&&J(l.changes,e.changes)||n=="input.type.compose")){s=V(s,s.length-1,o,new G(e.changes.compose(l.changes),P(e.effects,l.effects),l.mapped,l.startSelection,z))}else{s=V(s,s.length,o,e)}return new Y(s,z,t,n)}addSelection(e,t,n,r){let o=this.done.length?this.done[this.done.length-1].selectionsAfter:z;if(o.length>0&&t-this.prevTime<r&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&F(o[o.length-1],e))return this;return new Y(q(this.done,e),this.undone,t,n)}addMapping(e){return new Y($(this.done,e),$(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,n){let r=e==0?this.done:this.undone;if(r.length==0)return null;let o=r[r.length-1];if(n&&o.selectionsAfter.length){return t.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:S.of({side:e,rest:W(r)}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:true})}else if(!o.changes){return null}else{let n=r.length==1?z:r.slice(0,r.length-1);if(o.mapped)n=$(n,o.mapped);return t.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:S.of({side:e,rest:n}),filter:false,userEvent:e==0?"undo":"redo",scrollIntoView:true})}}}Y.empty=new Y(z,z);const Q=[{key:"Mod-z",run:O,preventDefault:true},{key:"Mod-y",mac:"Mod-Shift-z",run:E,preventDefault:true},{linux:"Ctrl-Shift-z",run:E,preventDefault:true},{key:"Mod-u",run:j,preventDefault:true},{key:"Alt-u",mac:"Mod-Shift-u",run:R,preventDefault:true}];function X(e,t){return r.jT.create(e.ranges.map(t),e.mainIndex)}function Z(e,t){return e.update({selection:t,scrollIntoView:true,userEvent:"select"})}function ee({state:e,dispatch:t},n){let r=X(e.selection,n);if(r.eq(e.selection))return false;t(Z(e,r));return true}function te(e,t){return r.jT.cursor(t?e.to:e.from)}function ne(e,t){return ee(e,(n=>n.empty?e.moveByChar(n,t):te(n,t)))}function re(e){return e.textDirectionAt(e.state.selection.main.head)==o.Nm.LTR}const oe=e=>ne(e,!re(e));const se=e=>ne(e,re(e));const le=e=>ne(e,true);const ae=e=>ne(e,false);function ie(e,t){return ee(e,(n=>n.empty?e.moveByGroup(n,t):te(n,t)))}const ce=e=>ie(e,!re(e));const ue=e=>ie(e,re(e));const fe=e=>ie(e,true);const he=e=>ie(e,false);function de(e,t,n){let o=e.state.charCategorizer(t.from);return e.moveByChar(t,n,(s=>{let l=r.D0.Space,a=t.from;let i=false,c=false,u=false;let f=t=>{if(i)return false;a+=n?t.length:-t.length;let s=o(t),f;if(l==r.D0.Space)l=s;if(l!=s)return false;if(l==r.D0.Word){if(t.toLowerCase()==t){if(!n&&c)return false;u=true}else if(u){if(n)return false;i=true}else{if(c&&n&&o(f=e.state.sliceDoc(a,a+1))==r.D0.Word&&f.toLowerCase()==f)return false;c=true}}return true};f(s);return f}))}function me(e,t){return ee(e,(n=>n.empty?de(e,n,t):te(n,t)))}const pe=e=>me(e,true);const ge=e=>me(e,false);function ye(e,t,n){if(t.type.prop(n))return true;let r=t.to-t.from;return r&&(r>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}function ke(e,t,n){let o=(0,s.qz)(e).resolveInner(t.head);let a=n?l.md.closedBy:l.md.openedBy;for(let r=t.head;;){let t=n?o.childAfter(r):o.childBefore(r);if(!t)break;if(ye(e,t,a))o=t;else r=n?t.to:t.from}let i=o.type.prop(a),c,u;if(i&&(c=n?(0,s.Um)(e,o.from,1):(0,s.Um)(e,o.to,-1))&&c.matched)u=n?c.end.to:c.end.from;else u=n?o.to:o.from;return r.jT.cursor(u,n?-1:1)}const we=e=>ee(e,(t=>ke(e.state,t,!re(e))));const Ae=e=>ee(e,(t=>ke(e.state,t,re(e))));function ve(e,t){return ee(e,(n=>{if(!n.empty)return te(n,t);let r=e.moveVertically(n,t);return r.head!=n.head?r:e.moveToLineBoundary(n,t)}))}const Se=e=>ve(e,false);const De=e=>ve(e,true);function Ce(e){return Math.max(e.defaultLineHeight,Math.min(e.dom.clientHeight,innerHeight)-5)}function Be(e,t){let{state:n}=e,r=X(n.selection,(n=>n.empty?e.moveVertically(n,t,Ce(e)):te(n,t)));if(r.eq(n.selection))return false;let s=e.coordsAtPos(n.selection.main.head);let l=e.scrollDOM.getBoundingClientRect();let a;if(s&&s.top>l.top&&s.bottom<l.bottom&&s.top-l.top<=e.scrollDOM.scrollHeight-e.scrollDOM.scrollTop-e.scrollDOM.clientHeight)a=o.tk.scrollIntoView(r.main.head,{y:"start",yMargin:s.top-l.top});e.dispatch(Z(n,r),{effects:a});return true}const Te=e=>Be(e,false);const xe=e=>Be(e,true);function Me(e,t,n){let o=e.lineBlockAt(t.head),s=e.moveToLineBoundary(t,n);if(s.head==t.head&&s.head!=(n?o.to:o.from))s=e.moveToLineBoundary(t,n,false);if(!n&&s.head==o.from&&o.length){let n=/^\s*/.exec(e.state.sliceDoc(o.from,Math.min(o.from+100,o.to)))[0].length;if(n&&t.head!=o.from+n)s=r.jT.cursor(o.from+n)}return s}const Le=e=>ee(e,(t=>Me(e,t,true)));const be=e=>ee(e,(t=>Me(e,t,false)));const Oe=e=>ee(e,(t=>r.jT.cursor(e.lineBlockAt(t.head).from,1)));const Ee=e=>ee(e,(t=>r.jT.cursor(e.lineBlockAt(t.head).to,-1)));function je(e,t,n){let o=false,l=X(e.selection,(t=>{let l=(0,s.Um)(e,t.head,-1)||(0,s.Um)(e,t.head,1)||t.head>0&&(0,s.Um)(e,t.head-1,1)||t.head<e.doc.length&&(0,s.Um)(e,t.head+1,-1);if(!l||!l.end)return t;o=true;let a=l.start.from==t.head?l.end.to:l.end.from;return n?r.jT.range(t.anchor,a):r.jT.cursor(a)}));if(!o)return false;t(Z(e,l));return true}const Re=({state:e,dispatch:t})=>je(e,t,false);const Ue=({state:e,dispatch:t})=>je(e,t,true);function Ie(e,t){let n=X(e.state.selection,(e=>{let n=t(e);return r.jT.range(e.anchor,n.head,n.goalColumn)}));if(n.eq(e.state.selection))return false;e.dispatch(Z(e.state,n));return true}function Ne(e,t){return Ie(e,(n=>e.moveByChar(n,t)))}const Ge=e=>Ne(e,!re(e));const Ve=e=>Ne(e,re(e));const Je=e=>Ne(e,true);const Fe=e=>Ne(e,false);function Pe(e,t){return Ie(e,(n=>e.moveByGroup(n,t)))}const ze=e=>Pe(e,!re(e));const He=e=>Pe(e,re(e));const qe=e=>Pe(e,true);const We=e=>Pe(e,false);function $e(e,t){return Ie(e,(n=>de(e,n,t)))}const Ke=e=>$e(e,true);const _e=e=>$e(e,false);const Ye=e=>Ie(e,(t=>ke(e.state,t,!re(e))));const Qe=e=>Ie(e,(t=>ke(e.state,t,re(e))));function Xe(e,t){return Ie(e,(n=>e.moveVertically(n,t)))}const Ze=e=>Xe(e,false);const et=e=>Xe(e,true);function tt(e,t){return Ie(e,(n=>e.moveVertically(n,t,Ce(e))))}const nt=e=>tt(e,false);const rt=e=>tt(e,true);const ot=e=>Ie(e,(t=>Me(e,t,true)));const st=e=>Ie(e,(t=>Me(e,t,false)));const lt=e=>Ie(e,(t=>r.jT.cursor(e.lineBlockAt(t.head).from)));const at=e=>Ie(e,(t=>r.jT.cursor(e.lineBlockAt(t.head).to)));const it=({state:e,dispatch:t})=>{t(Z(e,{anchor:0}));return true};const ct=({state:e,dispatch:t})=>{t(Z(e,{anchor:e.doc.length}));return true};const ut=({state:e,dispatch:t})=>{t(Z(e,{anchor:e.selection.main.anchor,head:0}));return true};const ft=({state:e,dispatch:t})=>{t(Z(e,{anchor:e.selection.main.anchor,head:e.doc.length}));return true};const ht=({state:e,dispatch:t})=>{t(e.update({selection:{anchor:0,head:e.doc.length},userEvent:"select"}));return true};const dt=({state:e,dispatch:t})=>{let n=Lt(e).map((({from:t,to:n})=>r.jT.range(t,Math.min(n+1,e.doc.length))));t(e.update({selection:r.jT.create(n),userEvent:"select"}));return true};const mt=({state:e,dispatch:t})=>{let n=X(e.selection,(t=>{var n;let o=(0,s.qz)(e).resolveInner(t.head,1);while(!(o.from<t.from&&o.to>=t.to||o.to>t.to&&o.from<=t.from||!((n=o.parent)===null||n===void 0?void 0:n.parent)))o=o.parent;return r.jT.range(o.to,o.from)}));t(Z(e,n));return true};const pt=({state:e,dispatch:t})=>{let n=e.selection,o=null;if(n.ranges.length>1)o=r.jT.create([n.main]);else if(!n.main.empty)o=r.jT.create([r.jT.cursor(n.main.head)]);if(!o)return false;t(Z(e,o));return true};function gt({state:e,dispatch:t},n){if(e.readOnly)return false;let s="delete.selection";let l=e.changeByRange((e=>{let{from:t,to:o}=e;if(t==o){let e=n(t);if(e<t)s="delete.backward";else if(e>t)s="delete.forward";t=Math.min(t,e);o=Math.max(o,e)}return t==o?{range:e}:{changes:{from:t,to:o},range:r.jT.cursor(t)}}));if(l.changes.empty)return false;t(e.update(l,{scrollIntoView:true,userEvent:s,effects:s=="delete.selection"?o.tk.announce.of(e.phrase("Selection deleted")):undefined}));return true}function yt(e,t,n){if(e instanceof o.tk)for(let r of e.state.facet(o.tk.atomicRanges).map((t=>t(e))))r.between(t,t,((e,r)=>{if(e<t&&r>t)t=n?r:e}));return t}const kt=(e,t)=>gt(e,(n=>{let{state:o}=e,l=o.doc.lineAt(n),a,i;if(!t&&n>l.from&&n<l.from+200&&!/[^ \t]/.test(a=l.text.slice(0,n-l.from))){if(a[a.length-1]=="\t")return n-1;let e=(0,r.IS)(a,o.tabSize),t=e%(0,s.y1)(o)||(0,s.y1)(o);for(let r=0;r<t&&a[a.length-1-r]==" ";r++)n--;i=n}else{i=(0,r.cp)(l.text,n-l.from,t,t)+l.from;if(i==n&&l.number!=(t?o.doc.lines:1))i+=t?1:-1}return yt(e,i,t)}));const wt=e=>kt(e,false);const At=e=>kt(e,true);const vt=(e,t)=>gt(e,(n=>{let o=n,{state:s}=e,l=s.doc.lineAt(o);let a=s.charCategorizer(o);for(let e=null;;){if(o==(t?l.to:l.from)){if(o==n&&l.number!=(t?s.doc.lines:1))o+=t?1:-1;break}let i=(0,r.cp)(l.text,o-l.from,t)+l.from;let c=l.text.slice(Math.min(o,i)-l.from,Math.max(o,i)-l.from);let u=a(c);if(e!=null&&u!=e)break;if(c!=" "||o!=n)e=u;o=i}return yt(e,o,t)}));const St=e=>vt(e,false);const Dt=e=>vt(e,true);const Ct=e=>gt(e,(t=>{let n=e.lineBlockAt(t).to;return yt(e,t<n?n:Math.min(e.state.doc.length,t+1),true)}));const Bt=e=>gt(e,(t=>{let n=e.lineBlockAt(t).from;return yt(e,t>n?n:Math.max(0,t-1),false)}));const Tt=({state:e,dispatch:t})=>{if(e.readOnly)return false;let n=[];for(let r=0,o="",s=e.doc.iter();;){s.next();if(s.lineBreak||s.done){let e=o.search(/\s+$/);if(e>-1)n.push({from:r-(o.length-e),to:r});if(s.done)break;o=""}else{o=s.value}r+=s.value.length}if(!n.length)return false;t(e.update({changes:n,userEvent:"delete"}));return true};const xt=({state:e,dispatch:t})=>{if(e.readOnly)return false;let n=e.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:r.xv.of(["",""])},range:r.jT.cursor(e.from)})));t(e.update(n,{scrollIntoView:true,userEvent:"input"}));return true};const Mt=({state:e,dispatch:t})=>{if(e.readOnly)return false;let n=e.changeByRange((t=>{if(!t.empty||t.from==0||t.from==e.doc.length)return{range:t};let n=t.from,o=e.doc.lineAt(n);let s=n==o.from?n-1:(0,r.cp)(o.text,n-o.from,false)+o.from;let l=n==o.to?n+1:(0,r.cp)(o.text,n-o.from,true)+o.from;return{changes:{from:s,to:l,insert:e.doc.slice(n,l).append(e.doc.slice(s,n))},range:r.jT.cursor(l)}}));if(n.changes.empty)return false;t(e.update(n,{scrollIntoView:true,userEvent:"move.character"}));return true};function Lt(e){let t=[],n=-1;for(let r of e.selection.ranges){let o=e.doc.lineAt(r.from),s=e.doc.lineAt(r.to);if(!r.empty&&r.to==s.from)s=e.doc.lineAt(r.to-1);if(n>=o.number){let e=t[t.length-1];e.to=s.to;e.ranges.push(r)}else{t.push({from:o.from,to:s.to,ranges:[r]})}n=s.number+1}return t}function bt(e,t,n){if(e.readOnly)return false;let o=[],s=[];for(let l of Lt(e)){if(n?l.to==e.doc.length:l.from==0)continue;let t=e.doc.lineAt(n?l.to+1:l.from-1);let a=t.length+1;if(n){o.push({from:l.to,to:t.to},{from:l.from,insert:t.text+e.lineBreak});for(let t of l.ranges)s.push(r.jT.range(Math.min(e.doc.length,t.anchor+a),Math.min(e.doc.length,t.head+a)))}else{o.push({from:t.from,to:l.from},{from:l.to,insert:e.lineBreak+t.text});for(let e of l.ranges)s.push(r.jT.range(e.anchor-a,e.head-a))}}if(!o.length)return false;t(e.update({changes:o,scrollIntoView:true,selection:r.jT.create(s,e.selection.mainIndex),userEvent:"move.line"}));return true}const Ot=({state:e,dispatch:t})=>bt(e,t,false);const Et=({state:e,dispatch:t})=>bt(e,t,true);function jt(e,t,n){if(e.readOnly)return false;let r=[];for(let o of Lt(e)){if(n)r.push({from:o.from,insert:e.doc.slice(o.from,o.to)+e.lineBreak});else r.push({from:o.to,insert:e.lineBreak+e.doc.slice(o.from,o.to)})}t(e.update({changes:r,scrollIntoView:true,userEvent:"input.copyline"}));return true}const Rt=({state:e,dispatch:t})=>jt(e,t,false);const Ut=({state:e,dispatch:t})=>jt(e,t,true);const It=e=>{if(e.state.readOnly)return false;let{state:t}=e,n=t.changes(Lt(t).map((({from:e,to:n})=>{if(e>0)e--;else if(n<t.doc.length)n++;return{from:e,to:n}})));let r=X(t.selection,(t=>e.moveVertically(t,true))).map(n);e.dispatch({changes:n,selection:r,scrollIntoView:true,userEvent:"delete.line"});return true};const Nt=({state:e,dispatch:t})=>{t(e.update(e.replaceSelection(e.lineBreak),{scrollIntoView:true,userEvent:"input"}));return true};function Gt(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let n=(0,s.qz)(e).resolveInner(t);let r=n.childBefore(t),o=n.childAfter(t),a;if(r&&o&&r.to<=t&&o.from>=t&&(a=r.type.prop(l.md.closedBy))&&a.indexOf(o.name)>-1&&e.doc.lineAt(r.to).from==e.doc.lineAt(o.from).from)return{from:r.to,to:o.from};return null}const Vt=Ft(false);const Jt=Ft(true);function Ft(e){return({state:t,dispatch:n})=>{if(t.readOnly)return false;let o=t.changeByRange((n=>{let{from:o,to:l}=n,a=t.doc.lineAt(o);let i=!e&&o==l&&Gt(t,o);if(e)o=l=(l<=a.to?a:t.doc.lineAt(l)).to;let c=new s.Gn(t,{simulateBreak:o,simulateDoubleBreak:!!i});let u=(0,s.K0)(c,o);if(u==null)u=/^\s*/.exec(t.doc.lineAt(o).text)[0].length;while(l<a.to&&/\s/.test(a.text[l-a.from]))l++;if(i)({from:o,to:l}=i);else if(o>a.from&&o<a.from+100&&!/\S/.test(a.text.slice(0,o)))o=a.from;let f=["",(0,s.SS)(t,u)];if(i)f.push((0,s.SS)(t,c.lineIndent(a.from,-1)));return{changes:{from:o,to:l,insert:r.xv.of(f)},range:r.jT.cursor(o+1+f[1].length)}}));n(t.update(o,{scrollIntoView:true,userEvent:"input"}));return true}}function Pt(e,t){let n=-1;return e.changeByRange((o=>{let s=[];for(let r=o.from;r<=o.to;){let l=e.doc.lineAt(r);if(l.number>n&&(o.empty||o.to>l.from)){t(l,s,o);n=l.number}r=l.to+1}let l=e.changes(s);return{changes:s,range:r.jT.range(l.mapPos(o.anchor,1),l.mapPos(o.head,1))}}))}const zt=({state:e,dispatch:t})=>{if(e.readOnly)return false;let n=Object.create(null);let r=new s.Gn(e,{overrideIndentation:e=>{let t=n[e];return t==null?-1:t}});let o=Pt(e,((t,o,l)=>{let a=(0,s.K0)(r,t.from);if(a==null)return;if(!/\S/.test(t.text))a=0;let i=/^\s*/.exec(t.text)[0];let c=(0,s.SS)(e,a);if(i!=c||l.from<t.from+i.length){n[t.from]=a;o.push({from:t.from,to:t.from+i.length,insert:c})}}));if(!o.changes.empty)t(e.update(o,{userEvent:"indent"}));return true};const Ht=({state:e,dispatch:t})=>{if(e.readOnly)return false;t(e.update(Pt(e,((t,n)=>{n.push({from:t.from,insert:e.facet(s.c)})})),{userEvent:"input.indent"}));return true};const qt=({state:e,dispatch:t})=>{if(e.readOnly)return false;t(e.update(Pt(e,((t,n)=>{let o=/^\s*/.exec(t.text)[0];if(!o)return;let l=(0,r.IS)(o,e.tabSize),a=0;let i=(0,s.SS)(e,Math.max(0,l-(0,s.y1)(e)));while(a<o.length&&a<i.length&&o.charCodeAt(a)==i.charCodeAt(a))a++;n.push({from:t.from+a,to:t.from+o.length,insert:i.slice(a)})})),{userEvent:"delete.dedent"}));return true};const Wt=({state:e,dispatch:t})=>{if(e.selection.ranges.some((e=>!e.empty)))return Ht({state:e,dispatch:t});t(e.update(e.replaceSelection("\t"),{scrollIntoView:true,userEvent:"input"}));return true};const $t=[{key:"Ctrl-b",run:oe,shift:Ge,preventDefault:true},{key:"Ctrl-f",run:se,shift:Ve},{key:"Ctrl-p",run:Se,shift:Ze},{key:"Ctrl-n",run:De,shift:et},{key:"Ctrl-a",run:Oe,shift:lt},{key:"Ctrl-e",run:Ee,shift:at},{key:"Ctrl-d",run:At},{key:"Ctrl-h",run:wt},{key:"Ctrl-k",run:Ct},{key:"Ctrl-Alt-h",run:St},{key:"Ctrl-o",run:xt},{key:"Ctrl-t",run:Mt},{key:"Ctrl-v",run:xe}];const Kt=[{key:"ArrowLeft",run:oe,shift:Ge,preventDefault:true},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:ce,shift:ze},{mac:"Cmd-ArrowLeft",run:be,shift:st},{key:"ArrowRight",run:se,shift:Ve,preventDefault:true},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:ue,shift:He},{mac:"Cmd-ArrowRight",run:Le,shift:ot},{key:"ArrowUp",run:Se,shift:Ze,preventDefault:true},{mac:"Cmd-ArrowUp",run:it,shift:ut},{mac:"Ctrl-ArrowUp",run:Te,shift:nt},{key:"ArrowDown",run:De,shift:et,preventDefault:true},{mac:"Cmd-ArrowDown",run:ct,shift:ft},{mac:"Ctrl-ArrowDown",run:xe,shift:rt},{key:"PageUp",run:Te,shift:nt},{key:"PageDown",run:xe,shift:rt},{key:"Home",run:be,shift:st,preventDefault:true},{key:"Mod-Home",run:it,shift:ut},{key:"End",run:Le,shift:ot,preventDefault:true},{key:"Mod-End",run:ct,shift:ft},{key:"Enter",run:Vt},{key:"Mod-a",run:ht},{key:"Backspace",run:wt,shift:wt},{key:"Delete",run:At},{key:"Mod-Backspace",mac:"Alt-Backspace",run:St},{key:"Mod-Delete",mac:"Alt-Delete",run:Dt},{mac:"Mod-Backspace",run:Bt},{mac:"Mod-Delete",run:Ct}].concat($t.map((e=>({mac:e.key,run:e.run,shift:e.shift}))));const _t=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:we,shift:Ye},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Ae,shift:Qe},{key:"Alt-ArrowUp",run:Ot},{key:"Shift-Alt-ArrowUp",run:Rt},{key:"Alt-ArrowDown",run:Et},{key:"Shift-Alt-ArrowDown",run:Ut},{key:"Escape",run:pt},{key:"Mod-Enter",run:Jt},{key:"Alt-l",mac:"Ctrl-l",run:dt},{key:"Mod-i",run:mt,preventDefault:true},{key:"Mod-[",run:qt},{key:"Mod-]",run:Ht},{key:"Mod-Alt-\\",run:zt},{key:"Shift-Mod-k",run:It},{key:"Shift-Mod-\\",run:Re},{key:"Mod-/",run:a},{key:"Alt-A",run:h}].concat(Kt);const Yt={key:"Tab",run:Ht,shift:qt}}}]);
//# sourceMappingURL=3547.17610774d6ac01e5e421.js.map?v=17610774d6ac01e5e421