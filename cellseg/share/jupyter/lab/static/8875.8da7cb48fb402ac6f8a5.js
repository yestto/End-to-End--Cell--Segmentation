(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[8875],{38554:(e,t,r)=>{e=r.nmd(e);var n=200;var i="__lodash_hash_undefined__";var s=800,o=16;var a=9007199254740991;var c="[object Arguments]",u="[object Array]",f="[object AsyncFunction]",l="[object Boolean]",d="[object Date]",h="[object Error]",p="[object Function]",g="[object GeneratorFunction]",m="[object Map]",y="[object Number]",b="[object Null]",v="[object Object]",_="[object Proxy]",w="[object RegExp]",T="[object Set]",E="[object String]",k="[object Undefined]",C="[object WeakMap]";var R="[object ArrayBuffer]",S="[object DataView]",j="[object Float32Array]",M="[object Float64Array]",O="[object Int8Array]",P="[object Int16Array]",N="[object Int32Array]",x="[object Uint8Array]",L="[object Uint8ClampedArray]",q="[object Uint16Array]",$="[object Uint32Array]";var A=/[\\^$.*+?()[\]{}|]/g;var D=/^\[object .+?Constructor\]$/;var z=/^(?:0|[1-9]\d*)$/;var I={};I[j]=I[M]=I[O]=I[P]=I[N]=I[x]=I[L]=I[q]=I[$]=true;I[c]=I[u]=I[R]=I[l]=I[S]=I[d]=I[h]=I[p]=I[m]=I[y]=I[v]=I[w]=I[T]=I[E]=I[C]=false;var W=typeof r.g=="object"&&r.g&&r.g.Object===Object&&r.g;var B=typeof self=="object"&&self&&self.Object===Object&&self;var F=W||B||Function("return this")();var U=true&&t&&!t.nodeType&&t;var V=U&&"object"=="object"&&e&&!e.nodeType&&e;var J=V&&V.exports===U;var H=J&&W.process;var G=function(){try{var e=V&&V.require&&V.require("util").types;if(e){return e}return H&&H.binding&&H.binding("util")}catch(t){}}();var K=G&&G.isTypedArray;function Q(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function X(e,t){var r=-1,n=Array(e);while(++r<e){n[r]=t(r)}return n}function Y(e){return function(t){return e(t)}}function Z(e,t){return e==null?undefined:e[t]}function ee(e,t){return function(r){return e(t(r))}}var te=Array.prototype,re=Function.prototype,ne=Object.prototype;var ie=F["__core-js_shared__"];var se=re.toString;var oe=ne.hasOwnProperty;var ae=function(){var e=/[^.]+$/.exec(ie&&ie.keys&&ie.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var ce=ne.toString;var ue=se.call(Object);var fe=RegExp("^"+se.call(oe).replace(A,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var le=J?F.Buffer:undefined,de=F.Symbol,he=F.Uint8Array,pe=le?le.allocUnsafe:undefined,ge=ee(Object.getPrototypeOf,Object),me=Object.create,ye=ne.propertyIsEnumerable,be=te.splice,ve=de?de.toStringTag:undefined;var _e=function(){try{var e=_t(Object,"defineProperty");e({},"",{});return e}catch(t){}}();var we=le?le.isBuffer:undefined,Te=Math.max,Ee=Date.now;var ke=_t(F,"Map"),Ce=_t(Object,"create");var Re=function(){function e(){}return function(t){if(!Ft(t)){return{}}if(me){return me(t)}e.prototype=t;var r=new e;e.prototype=undefined;return r}}();function Se(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}function je(){this.__data__=Ce?Ce(null):{};this.size=0}function Me(e){var t=this.has(e)&&delete this.__data__[e];this.size-=t?1:0;return t}function Oe(e){var t=this.__data__;if(Ce){var r=t[e];return r===i?undefined:r}return oe.call(t,e)?t[e]:undefined}function Pe(e){var t=this.__data__;return Ce?t[e]!==undefined:oe.call(t,e)}function Ne(e,t){var r=this.__data__;this.size+=this.has(e)?0:1;r[e]=Ce&&t===undefined?i:t;return this}Se.prototype.clear=je;Se.prototype["delete"]=Me;Se.prototype.get=Oe;Se.prototype.has=Pe;Se.prototype.set=Ne;function xe(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}function Le(){this.__data__=[];this.size=0}function qe(e){var t=this.__data__,r=et(t,e);if(r<0){return false}var n=t.length-1;if(r==n){t.pop()}else{be.call(t,r,1)}--this.size;return true}function $e(e){var t=this.__data__,r=et(t,e);return r<0?undefined:t[r][1]}function Ae(e){return et(this.__data__,e)>-1}function De(e,t){var r=this.__data__,n=et(r,e);if(n<0){++this.size;r.push([e,t])}else{r[n][1]=t}return this}xe.prototype.clear=Le;xe.prototype["delete"]=qe;xe.prototype.get=$e;xe.prototype.has=Ae;xe.prototype.set=De;function ze(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}function Ie(){this.size=0;this.__data__={hash:new Se,map:new(ke||xe),string:new Se}}function We(e){var t=vt(this,e)["delete"](e);this.size-=t?1:0;return t}function Be(e){return vt(this,e).get(e)}function Fe(e){return vt(this,e).has(e)}function Ue(e,t){var r=vt(this,e),n=r.size;r.set(e,t);this.size+=r.size==n?0:1;return this}ze.prototype.clear=Ie;ze.prototype["delete"]=We;ze.prototype.get=Be;ze.prototype.has=Fe;ze.prototype.set=Ue;function Ve(e){var t=this.__data__=new xe(e);this.size=t.size}function Je(){this.__data__=new xe;this.size=0}function He(e){var t=this.__data__,r=t["delete"](e);this.size=t.size;return r}function Ge(e){return this.__data__.get(e)}function Ke(e){return this.__data__.has(e)}function Qe(e,t){var r=this.__data__;if(r instanceof xe){var i=r.__data__;if(!ke||i.length<n-1){i.push([e,t]);this.size=++r.size;return this}r=this.__data__=new ze(i)}r.set(e,t);this.size=r.size;return this}Ve.prototype.clear=Je;Ve.prototype["delete"]=He;Ve.prototype.get=Ge;Ve.prototype.has=Ke;Ve.prototype.set=Qe;function Xe(e,t){var r=At(e),n=!r&&$t(e),i=!r&&!n&&It(e),s=!r&&!n&&!i&&Jt(e),o=r||n||i||s,a=o?X(e.length,String):[],c=a.length;for(var u in e){if((t||oe.call(e,u))&&!(o&&(u=="length"||i&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Et(u,c)))){a.push(u)}}return a}function Ye(e,t,r){if(r!==undefined&&!qt(e[t],r)||r===undefined&&!(t in e)){tt(e,t,r)}}function Ze(e,t,r){var n=e[t];if(!(oe.call(e,t)&&qt(n,r))||r===undefined&&!(t in e)){tt(e,t,r)}}function et(e,t){var r=e.length;while(r--){if(qt(e[r][0],t)){return r}}return-1}function tt(e,t,r){if(t=="__proto__"&&_e){_e(e,t,{configurable:true,enumerable:true,value:r,writable:true})}else{e[t]=r}}var rt=bt();function nt(e){if(e==null){return e===undefined?k:b}return ve&&ve in Object(e)?wt(e):Mt(e)}function it(e){return Ut(e)&&nt(e)==c}function st(e){if(!Ft(e)||Rt(e)){return false}var t=Wt(e)?fe:D;return t.test(Lt(e))}function ot(e){return Ut(e)&&Bt(e.length)&&!!I[nt(e)]}function at(e){if(!Ft(e)){return jt(e)}var t=St(e),r=[];for(var n in e){if(!(n=="constructor"&&(t||!oe.call(e,n)))){r.push(n)}}return r}function ct(e,t,r,n,i){if(e===t){return}rt(t,(function(s,o){i||(i=new Ve);if(Ft(s)){ut(e,t,o,r,ct,n,i)}else{var a=n?n(Pt(e,o),s,o+"",e,t,i):undefined;if(a===undefined){a=s}Ye(e,o,a)}}),Gt)}function ut(e,t,r,n,i,s,o){var a=Pt(e,r),c=Pt(t,r),u=o.get(c);if(u){Ye(e,r,u);return}var f=s?s(a,c,r+"",e,t,o):undefined;var l=f===undefined;if(l){var d=At(c),h=!d&&It(c),p=!d&&!h&&Jt(c);f=c;if(d||h||p){if(At(a)){f=a}else if(zt(a)){f=gt(a)}else if(h){l=false;f=dt(c,true)}else if(p){l=false;f=pt(c,true)}else{f=[]}}else if(Vt(c)||$t(c)){f=a;if($t(a)){f=Ht(a)}else if(!Ft(a)||Wt(a)){f=Tt(c)}}else{l=false}}if(l){o.set(c,f);i(f,c,n,s,o);o["delete"](c)}Ye(e,r,f)}function ft(e,t){return Nt(Ot(e,t,Xt),e+"")}var lt=!_e?Xt:function(e,t){return _e(e,"toString",{configurable:true,enumerable:false,value:Qt(t),writable:true})};function dt(e,t){if(t){return e.slice()}var r=e.length,n=pe?pe(r):new e.constructor(r);e.copy(n);return n}function ht(e){var t=new e.constructor(e.byteLength);new he(t).set(new he(e));return t}function pt(e,t){var r=t?ht(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function gt(e,t){var r=-1,n=e.length;t||(t=Array(n));while(++r<n){t[r]=e[r]}return t}function mt(e,t,r,n){var i=!r;r||(r={});var s=-1,o=t.length;while(++s<o){var a=t[s];var c=n?n(r[a],e[a],a,r,e):undefined;if(c===undefined){c=e[a]}if(i){tt(r,a,c)}else{Ze(r,a,c)}}return r}function yt(e){return ft((function(t,r){var n=-1,i=r.length,s=i>1?r[i-1]:undefined,o=i>2?r[2]:undefined;s=e.length>3&&typeof s=="function"?(i--,s):undefined;if(o&&kt(r[0],r[1],o)){s=i<3?undefined:s;i=1}t=Object(t);while(++n<i){var a=r[n];if(a){e(t,a,n,s)}}return t}))}function bt(e){return function(t,r,n){var i=-1,s=Object(t),o=n(t),a=o.length;while(a--){var c=o[e?a:++i];if(r(s[c],c,s)===false){break}}return t}}function vt(e,t){var r=e.__data__;return Ct(t)?r[typeof t=="string"?"string":"hash"]:r.map}function _t(e,t){var r=Z(e,t);return st(r)?r:undefined}function wt(e){var t=oe.call(e,ve),r=e[ve];try{e[ve]=undefined;var n=true}catch(s){}var i=ce.call(e);if(n){if(t){e[ve]=r}else{delete e[ve]}}return i}function Tt(e){return typeof e.constructor=="function"&&!St(e)?Re(ge(e)):{}}function Et(e,t){var r=typeof e;t=t==null?a:t;return!!t&&(r=="number"||r!="symbol"&&z.test(e))&&(e>-1&&e%1==0&&e<t)}function kt(e,t,r){if(!Ft(r)){return false}var n=typeof t;if(n=="number"?Dt(r)&&Et(t,r.length):n=="string"&&t in r){return qt(r[t],e)}return false}function Ct(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Rt(e){return!!ae&&ae in e}function St(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||ne;return e===r}function jt(e){var t=[];if(e!=null){for(var r in Object(e)){t.push(r)}}return t}function Mt(e){return ce.call(e)}function Ot(e,t,r){t=Te(t===undefined?e.length-1:t,0);return function(){var n=arguments,i=-1,s=Te(n.length-t,0),o=Array(s);while(++i<s){o[i]=n[t+i]}i=-1;var a=Array(t+1);while(++i<t){a[i]=n[i]}a[t]=r(o);return Q(e,this,a)}}function Pt(e,t){if(t==="constructor"&&typeof e[t]==="function"){return}if(t=="__proto__"){return}return e[t]}var Nt=xt(lt);function xt(e){var t=0,r=0;return function(){var n=Ee(),i=o-(n-r);r=n;if(i>0){if(++t>=s){return arguments[0]}}else{t=0}return e.apply(undefined,arguments)}}function Lt(e){if(e!=null){try{return se.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function qt(e,t){return e===t||e!==e&&t!==t}var $t=it(function(){return arguments}())?it:function(e){return Ut(e)&&oe.call(e,"callee")&&!ye.call(e,"callee")};var At=Array.isArray;function Dt(e){return e!=null&&Bt(e.length)&&!Wt(e)}function zt(e){return Ut(e)&&Dt(e)}var It=we||Yt;function Wt(e){if(!Ft(e)){return false}var t=nt(e);return t==p||t==g||t==f||t==_}function Bt(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=a}function Ft(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function Ut(e){return e!=null&&typeof e=="object"}function Vt(e){if(!Ut(e)||nt(e)!=v){return false}var t=ge(e);if(t===null){return true}var r=oe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&se.call(r)==ue}var Jt=K?Y(K):ot;function Ht(e){return mt(e,Gt(e))}function Gt(e){return Dt(e)?Xe(e,true):at(e)}var Kt=yt((function(e,t,r,n){ct(e,t,r,n)}));function Qt(e){return function(){return e}}function Xt(e){return e}function Yt(){return false}e.exports=Kt},39054:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){if(n===undefined)n=r;var i=Object.getOwnPropertyDescriptor(t,r);if(!i||("get"in i?!t.__esModule:i.writable||i.configurable)){i={enumerable:true,get:function(){return t[r]}}}Object.defineProperty(e,n,i)}:function(e,t,r,n){if(n===undefined)n=r;e[n]=t[r]});var i=this&&this.__exportStar||function(e,t){for(var r in e)if(r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r))n(t,e,r)};Object.defineProperty(t,"__esModule",{value:true});t.createMessageConnection=t.BrowserMessageWriter=t.BrowserMessageReader=void 0;const s=r(25669);s.default.install();const o=r(23870);i(r(23870),t);class a extends o.AbstractMessageReader{constructor(e){super();this._onData=new o.Emitter;this._messageListener=e=>{this._onData.fire(e.data)};e.addEventListener("error",(e=>this.fireError(e)));e.onmessage=this._messageListener}listen(e){return this._onData.event(e)}}t.BrowserMessageReader=a;class c extends o.AbstractMessageWriter{constructor(e){super();this.context=e;this.errorCount=0;e.addEventListener("error",(e=>this.fireError(e)))}write(e){try{this.context.postMessage(e);return Promise.resolve()}catch(t){this.handleError(t,e);return Promise.reject(t)}}handleError(e,t){this.errorCount++;this.fireError(e,t,this.errorCount)}end(){}}t.BrowserMessageWriter=c;function u(e,t,r,n){if(r===undefined){r=o.NullLogger}if(o.ConnectionStrategy.is(n)){n={connectionStrategy:n}}return(0,o.createMessageConnection)(e,t,r,n)}t.createMessageConnection=u},25669:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});const n=r(30147);const i=r(83911);const s=r(27135);const o=r(75530);class a extends o.AbstractMessageBuffer{constructor(e="utf-8"){super(e);this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return a.emptyBuffer}fromString(e,t){return(new TextEncoder).encode(e)}toString(e,t){if(t==="ascii"){return this.asciiDecoder.decode(e)}else{return new TextDecoder(t).decode(e)}}asNative(e,t){if(t===undefined){return e}else{return e.slice(0,t)}}allocNative(e){return new Uint8Array(e)}}a.emptyBuffer=new Uint8Array(0);class c{constructor(e){this.socket=e;this._onData=new s.Emitter;this._messageListener=e=>{const t=e.data;t.arrayBuffer().then((e=>{this._onData.fire(new Uint8Array(e))}),(()=>{(0,n.default)().console.error(`Converting blob to array buffer failed.`)}))};this.socket.addEventListener("message",this._messageListener)}onClose(e){this.socket.addEventListener("close",e);return i.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){this.socket.addEventListener("error",e);return i.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){this.socket.addEventListener("end",e);return i.Disposable.create((()=>this.socket.removeEventListener("end",e)))}onData(e){return this._onData.event(e)}}class u{constructor(e){this.socket=e}onClose(e){this.socket.addEventListener("close",e);return i.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){this.socket.addEventListener("error",e);return i.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){this.socket.addEventListener("end",e);return i.Disposable.create((()=>this.socket.removeEventListener("end",e)))}write(e,t){if(typeof e==="string"){if(t!==undefined&&t!=="utf-8"){throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t}`)}this.socket.send(e)}else{this.socket.send(e)}return Promise.resolve()}end(){this.socket.close()}}const f=new TextEncoder;const l=Object.freeze({messageBuffer:Object.freeze({create:e=>new a(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{if(t.charset!=="utf-8"){throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t.charset}`)}return Promise.resolve(f.encode(JSON.stringify(e,undefined,0)))}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{if(!(e instanceof Uint8Array)){throw new Error(`In a Browser environments only Uint8Arrays are supported.`)}return Promise.resolve(JSON.parse(new TextDecoder(t.charset).decode(e)))}})}),stream:Object.freeze({asReadableStream:e=>new c(e),asWritableStream:e=>new u(e)}),console,timer:Object.freeze({setTimeout(e,t,...r){const n=setTimeout(e,t,...r);return{dispose:()=>clearTimeout(n)}},setImmediate(e,...t){const r=setTimeout(e,0,...t);return{dispose:()=>clearTimeout(r)}},setInterval(e,t,...r){const n=setInterval(e,t,...r);return{dispose:()=>clearInterval(n)}}})});function d(){return l}(function(e){function t(){n.default.install(l)}e.install=t})(d||(d={}));t["default"]=d},23870:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TraceFormat=t.TraceValues=t.Trace=t.ProgressType=t.ProgressToken=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.LRUCache=t.Touch=t.LinkedMap=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.Message=t.RAL=void 0;t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=void 0;const n=r(20839);Object.defineProperty(t,"Message",{enumerable:true,get:function(){return n.Message}});Object.defineProperty(t,"RequestType",{enumerable:true,get:function(){return n.RequestType}});Object.defineProperty(t,"RequestType0",{enumerable:true,get:function(){return n.RequestType0}});Object.defineProperty(t,"RequestType1",{enumerable:true,get:function(){return n.RequestType1}});Object.defineProperty(t,"RequestType2",{enumerable:true,get:function(){return n.RequestType2}});Object.defineProperty(t,"RequestType3",{enumerable:true,get:function(){return n.RequestType3}});Object.defineProperty(t,"RequestType4",{enumerable:true,get:function(){return n.RequestType4}});Object.defineProperty(t,"RequestType5",{enumerable:true,get:function(){return n.RequestType5}});Object.defineProperty(t,"RequestType6",{enumerable:true,get:function(){return n.RequestType6}});Object.defineProperty(t,"RequestType7",{enumerable:true,get:function(){return n.RequestType7}});Object.defineProperty(t,"RequestType8",{enumerable:true,get:function(){return n.RequestType8}});Object.defineProperty(t,"RequestType9",{enumerable:true,get:function(){return n.RequestType9}});Object.defineProperty(t,"ResponseError",{enumerable:true,get:function(){return n.ResponseError}});Object.defineProperty(t,"ErrorCodes",{enumerable:true,get:function(){return n.ErrorCodes}});Object.defineProperty(t,"NotificationType",{enumerable:true,get:function(){return n.NotificationType}});Object.defineProperty(t,"NotificationType0",{enumerable:true,get:function(){return n.NotificationType0}});Object.defineProperty(t,"NotificationType1",{enumerable:true,get:function(){return n.NotificationType1}});Object.defineProperty(t,"NotificationType2",{enumerable:true,get:function(){return n.NotificationType2}});Object.defineProperty(t,"NotificationType3",{enumerable:true,get:function(){return n.NotificationType3}});Object.defineProperty(t,"NotificationType4",{enumerable:true,get:function(){return n.NotificationType4}});Object.defineProperty(t,"NotificationType5",{enumerable:true,get:function(){return n.NotificationType5}});Object.defineProperty(t,"NotificationType6",{enumerable:true,get:function(){return n.NotificationType6}});Object.defineProperty(t,"NotificationType7",{enumerable:true,get:function(){return n.NotificationType7}});Object.defineProperty(t,"NotificationType8",{enumerable:true,get:function(){return n.NotificationType8}});Object.defineProperty(t,"NotificationType9",{enumerable:true,get:function(){return n.NotificationType9}});Object.defineProperty(t,"ParameterStructures",{enumerable:true,get:function(){return n.ParameterStructures}});const i=r(96184);Object.defineProperty(t,"LinkedMap",{enumerable:true,get:function(){return i.LinkedMap}});Object.defineProperty(t,"LRUCache",{enumerable:true,get:function(){return i.LRUCache}});Object.defineProperty(t,"Touch",{enumerable:true,get:function(){return i.Touch}});const s=r(83911);Object.defineProperty(t,"Disposable",{enumerable:true,get:function(){return s.Disposable}});const o=r(27135);Object.defineProperty(t,"Event",{enumerable:true,get:function(){return o.Event}});Object.defineProperty(t,"Emitter",{enumerable:true,get:function(){return o.Emitter}});const a=r(13881);Object.defineProperty(t,"CancellationTokenSource",{enumerable:true,get:function(){return a.CancellationTokenSource}});Object.defineProperty(t,"CancellationToken",{enumerable:true,get:function(){return a.CancellationToken}});const c=r(56525);Object.defineProperty(t,"MessageReader",{enumerable:true,get:function(){return c.MessageReader}});Object.defineProperty(t,"AbstractMessageReader",{enumerable:true,get:function(){return c.AbstractMessageReader}});Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:true,get:function(){return c.ReadableStreamMessageReader}});const u=r(96654);Object.defineProperty(t,"MessageWriter",{enumerable:true,get:function(){return u.MessageWriter}});Object.defineProperty(t,"AbstractMessageWriter",{enumerable:true,get:function(){return u.AbstractMessageWriter}});Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:true,get:function(){return u.WriteableStreamMessageWriter}});const f=r(61343);Object.defineProperty(t,"ConnectionStrategy",{enumerable:true,get:function(){return f.ConnectionStrategy}});Object.defineProperty(t,"ConnectionOptions",{enumerable:true,get:function(){return f.ConnectionOptions}});Object.defineProperty(t,"NullLogger",{enumerable:true,get:function(){return f.NullLogger}});Object.defineProperty(t,"createMessageConnection",{enumerable:true,get:function(){return f.createMessageConnection}});Object.defineProperty(t,"ProgressToken",{enumerable:true,get:function(){return f.ProgressToken}});Object.defineProperty(t,"ProgressType",{enumerable:true,get:function(){return f.ProgressType}});Object.defineProperty(t,"Trace",{enumerable:true,get:function(){return f.Trace}});Object.defineProperty(t,"TraceValues",{enumerable:true,get:function(){return f.TraceValues}});Object.defineProperty(t,"TraceFormat",{enumerable:true,get:function(){return f.TraceFormat}});Object.defineProperty(t,"SetTraceNotification",{enumerable:true,get:function(){return f.SetTraceNotification}});Object.defineProperty(t,"LogTraceNotification",{enumerable:true,get:function(){return f.LogTraceNotification}});Object.defineProperty(t,"ConnectionErrors",{enumerable:true,get:function(){return f.ConnectionErrors}});Object.defineProperty(t,"ConnectionError",{enumerable:true,get:function(){return f.ConnectionError}});Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:true,get:function(){return f.CancellationReceiverStrategy}});Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:true,get:function(){return f.CancellationSenderStrategy}});Object.defineProperty(t,"CancellationStrategy",{enumerable:true,get:function(){return f.CancellationStrategy}});const l=r(30147);t.RAL=l.default},13881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CancellationTokenSource=t.CancellationToken=void 0;const n=r(30147);const i=r(67574);const s=r(27135);var o;(function(e){e.None=Object.freeze({isCancellationRequested:false,onCancellationRequested:s.Event.None});e.Cancelled=Object.freeze({isCancellationRequested:true,onCancellationRequested:s.Event.None});function t(t){const r=t;return r&&(r===e.None||r===e.Cancelled||i.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}e.is=t})(o=t.CancellationToken||(t.CancellationToken={}));const a=Object.freeze((function(e,t){const r=(0,n.default)().timer.setTimeout(e.bind(t),0);return{dispose(){r.dispose()}}}));class c{constructor(){this._isCancelled=false}cancel(){if(!this._isCancelled){this._isCancelled=true;if(this._emitter){this._emitter.fire(undefined);this.dispose()}}}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){if(this._isCancelled){return a}if(!this._emitter){this._emitter=new s.Emitter}return this._emitter.event}dispose(){if(this._emitter){this._emitter.dispose();this._emitter=undefined}}}class u{get token(){if(!this._token){this._token=new c}return this._token}cancel(){if(!this._token){this._token=o.Cancelled}else{this._token.cancel()}}dispose(){if(!this._token){this._token=o.None}else if(this._token instanceof c){this._token.dispose()}}}t.CancellationTokenSource=u},61343:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.createMessageConnection=t.ConnectionOptions=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=t.NullLogger=t.ProgressType=t.ProgressToken=void 0;const n=r(30147);const i=r(67574);const s=r(20839);const o=r(96184);const a=r(27135);const c=r(13881);var u;(function(e){e.type=new s.NotificationType("$/cancelRequest")})(u||(u={}));var f;(function(e){function t(e){return typeof e==="string"||typeof e==="number"}e.is=t})(f=t.ProgressToken||(t.ProgressToken={}));var l;(function(e){e.type=new s.NotificationType("$/progress")})(l||(l={}));class d{constructor(){}}t.ProgressType=d;var h;(function(e){function t(e){return i.func(e)}e.is=t})(h||(h={}));t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var p;(function(e){e[e["Off"]=0]="Off";e[e["Messages"]=1]="Messages";e[e["Compact"]=2]="Compact";e[e["Verbose"]=3]="Verbose"})(p=t.Trace||(t.Trace={}));var g;(function(e){e.Off="off";e.Messages="messages";e.Compact="compact";e.Verbose="verbose"})(g=t.TraceValues||(t.TraceValues={}));(function(e){function t(t){if(!i.string(t)){return e.Off}t=t.toLowerCase();switch(t){case"off":return e.Off;case"messages":return e.Messages;case"compact":return e.Compact;case"verbose":return e.Verbose;default:return e.Off}}e.fromString=t;function r(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Compact:return"compact";case e.Verbose:return"verbose";default:return"off"}}e.toString=r})(p=t.Trace||(t.Trace={}));var m;(function(e){e["Text"]="text";e["JSON"]="json"})(m=t.TraceFormat||(t.TraceFormat={}));(function(e){function t(t){if(!i.string(t)){return e.Text}t=t.toLowerCase();if(t==="json"){return e.JSON}else{return e.Text}}e.fromString=t})(m=t.TraceFormat||(t.TraceFormat={}));var y;(function(e){e.type=new s.NotificationType("$/setTrace")})(y=t.SetTraceNotification||(t.SetTraceNotification={}));var b;(function(e){e.type=new s.NotificationType("$/logTrace")})(b=t.LogTraceNotification||(t.LogTraceNotification={}));var v;(function(e){e[e["Closed"]=1]="Closed";e[e["Disposed"]=2]="Disposed";e[e["AlreadyListening"]=3]="AlreadyListening"})(v=t.ConnectionErrors||(t.ConnectionErrors={}));class _ extends Error{constructor(e,t){super(t);this.code=e;Object.setPrototypeOf(this,_.prototype)}}t.ConnectionError=_;var w;(function(e){function t(e){const t=e;return t&&i.func(t.cancelUndispatched)}e.is=t})(w=t.ConnectionStrategy||(t.ConnectionStrategy={}));var T;(function(e){e.Message=Object.freeze({createCancellationTokenSource(e){return new c.CancellationTokenSource}});function t(e){const t=e;return t&&i.func(t.createCancellationTokenSource)}e.is=t})(T=t.CancellationReceiverStrategy||(t.CancellationReceiverStrategy={}));var E;(function(e){e.Message=Object.freeze({sendCancellation(e,t){return e.sendNotification(u.type,{id:t})},cleanup(e){}});function t(e){const t=e;return t&&i.func(t.sendCancellation)&&i.func(t.cleanup)}e.is=t})(E=t.CancellationSenderStrategy||(t.CancellationSenderStrategy={}));var k;(function(e){e.Message=Object.freeze({receiver:T.Message,sender:E.Message});function t(e){const t=e;return t&&T.is(t.receiver)&&E.is(t.sender)}e.is=t})(k=t.CancellationStrategy||(t.CancellationStrategy={}));var C;(function(e){function t(e){const t=e;return t&&(k.is(t.cancellationStrategy)||w.is(t.connectionStrategy))}e.is=t})(C=t.ConnectionOptions||(t.ConnectionOptions={}));var R;(function(e){e[e["New"]=1]="New";e[e["Listening"]=2]="Listening";e[e["Closed"]=3]="Closed";e[e["Disposed"]=4]="Disposed"})(R||(R={}));function S(e,r,d,g){const w=d!==undefined?d:t.NullLogger;let T=0;let E=0;let C=0;const S="2.0";let j=undefined;const M=new Map;let O=undefined;const P=new Map;const N=new Map;let x;let L=new o.LinkedMap;let q=new Map;let $=new Set;let A=new Map;let D=p.Off;let z=m.Text;let I;let W=R.New;const B=new a.Emitter;const F=new a.Emitter;const U=new a.Emitter;const V=new a.Emitter;const J=new a.Emitter;const H=g&&g.cancellationStrategy?g.cancellationStrategy:k.Message;function G(e){if(e===null){throw new Error(`Can't send requests with id null since the response can't be correlated.`)}return"req-"+e.toString()}function K(e){if(e===null){return"res-unknown-"+(++C).toString()}else{return"res-"+e.toString()}}function Q(){return"not-"+(++E).toString()}function X(e,t){if(s.Message.isRequest(t)){e.set(G(t.id),t)}else if(s.Message.isResponse(t)){e.set(K(t.id),t)}else{e.set(Q(),t)}}function Y(e){return undefined}function Z(){return W===R.Listening}function ee(){return W===R.Closed}function te(){return W===R.Disposed}function re(){if(W===R.New||W===R.Listening){W=R.Closed;F.fire(undefined)}}function ne(e){B.fire([e,undefined,undefined])}function ie(e){B.fire(e)}e.onClose(re);e.onError(ne);r.onClose(re);r.onError(ie);function se(){if(x||L.size===0){return}x=(0,n.default)().timer.setImmediate((()=>{x=undefined;oe()}))}function oe(){if(L.size===0){return}const e=L.shift();try{if(s.Message.isRequest(e)){ce(e)}else if(s.Message.isNotification(e)){fe(e)}else if(s.Message.isResponse(e)){ue(e)}else{le(e)}}finally{se()}}const ae=e=>{try{if(s.Message.isNotification(e)&&e.method===u.type.method){const t=e.params.id;const n=G(t);const i=L.get(n);if(s.Message.isRequest(i)){const s=g?.connectionStrategy;const o=s&&s.cancelUndispatched?s.cancelUndispatched(i,Y):Y(i);if(o&&(o.error!==undefined||o.result!==undefined)){L.delete(n);A.delete(t);o.id=i.id;ge(o,e.method,Date.now());r.write(o).catch((()=>w.error(`Sending response for canceled message failed.`)));return}}const o=A.get(t);if(o!==undefined){o.cancel();ye(e);return}else{$.add(t)}}X(L,e)}finally{se()}};function ce(e){if(te()){return}function t(t,n,i){const o={jsonrpc:S,id:e.id};if(t instanceof s.ResponseError){o.error=t.toJson()}else{o.result=t===undefined?null:t}ge(o,n,i);r.write(o).catch((()=>w.error(`Sending response failed.`)))}function n(t,n,i){const s={jsonrpc:S,id:e.id,error:t.toJson()};ge(s,n,i);r.write(s).catch((()=>w.error(`Sending response failed.`)))}function o(t,n,i){if(t===undefined){t=null}const s={jsonrpc:S,id:e.id,result:t};ge(s,n,i);r.write(s).catch((()=>w.error(`Sending response failed.`)))}me(e);const a=M.get(e.method);let c;let u;if(a){c=a.type;u=a.handler}const f=Date.now();if(u||j){const r=e.id??String(Date.now());const a=H.receiver.createCancellationTokenSource(r);if(e.id!==null&&$.has(e.id)){a.cancel()}if(e.id!==null){A.set(r,a)}try{let l;if(u){if(e.params===undefined){if(c!==undefined&&c.numberOfParams!==0){n(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${e.method} defines ${c.numberOfParams} params but received none.`),e.method,f);return}l=u(a.token)}else if(Array.isArray(e.params)){if(c!==undefined&&c.parameterStructures===s.ParameterStructures.byName){n(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by name but received parameters by position`),e.method,f);return}l=u(...e.params,a.token)}else{if(c!==undefined&&c.parameterStructures===s.ParameterStructures.byPosition){n(new s.ResponseError(s.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by position but received parameters by name`),e.method,f);return}l=u(e.params,a.token)}}else if(j){l=j(e.method,e.params,a.token)}const d=l;if(!l){A.delete(r);o(l,e.method,f)}else if(d.then){d.then((n=>{A.delete(r);t(n,e.method,f)}),(t=>{A.delete(r);if(t instanceof s.ResponseError){n(t,e.method,f)}else if(t&&i.string(t.message)){n(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,f)}else{n(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,f)}}))}else{A.delete(r);t(l,e.method,f)}}catch(l){A.delete(r);if(l instanceof s.ResponseError){t(l,e.method,f)}else if(l&&i.string(l.message)){n(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${l.message}`),e.method,f)}else{n(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,f)}}}else{n(new s.ResponseError(s.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,f)}}function ue(e){if(te()){return}if(e.id===null){if(e.error){w.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,undefined,4)}`)}else{w.error(`Received response message without id. No further error information provided.`)}}else{const r=e.id;const n=q.get(r);be(e,n);if(n!==undefined){q.delete(r);try{if(e.error){const t=e.error;n.reject(new s.ResponseError(t.code,t.message,t.data))}else if(e.result!==undefined){n.resolve(e.result)}else{throw new Error("Should never happen.")}}catch(t){if(t.message){w.error(`Response handler '${n.method}' failed with message: ${t.message}`)}else{w.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}}function fe(e){if(te()){return}let t=undefined;let r;if(e.method===u.type.method){const t=e.params.id;$.delete(t);ye(e);return}else{const n=P.get(e.method);if(n){r=n.handler;t=n.type}}if(r||O){try{ye(e);if(r){if(e.params===undefined){if(t!==undefined){if(t.numberOfParams!==0&&t.parameterStructures!==s.ParameterStructures.byName){w.error(`Notification ${e.method} defines ${t.numberOfParams} params but received none.`)}}r()}else if(Array.isArray(e.params)){const n=e.params;if(e.method===l.type.method&&n.length===2&&f.is(n[0])){r({token:n[0],value:n[1]})}else{if(t!==undefined){if(t.parameterStructures===s.ParameterStructures.byName){w.error(`Notification ${e.method} defines parameters by name but received parameters by position`)}if(t.numberOfParams!==e.params.length){w.error(`Notification ${e.method} defines ${t.numberOfParams} params but received ${n.length} arguments`)}}r(...n)}}else{if(t!==undefined&&t.parameterStructures===s.ParameterStructures.byPosition){w.error(`Notification ${e.method} defines parameters by position but received parameters by name`)}r(e.params)}}else if(O){O(e.method,e.params)}}catch(n){if(n.message){w.error(`Notification handler '${e.method}' failed with message: ${n.message}`)}else{w.error(`Notification handler '${e.method}' failed unexpectedly.`)}}}else{U.fire(e)}}function le(e){if(!e){w.error("Received empty message.");return}w.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);const t=e;if(i.string(t.id)||i.number(t.id)){const e=t.id;const r=q.get(e);if(r){r.reject(new Error("The received response has neither a result nor an error property."))}}}function de(e){if(e===undefined||e===null){return undefined}switch(D){case p.Verbose:return JSON.stringify(e,null,4);case p.Compact:return JSON.stringify(e);default:return undefined}}function he(e){if(D===p.Off||!I){return}if(z===m.Text){let t=undefined;if((D===p.Verbose||D===p.Compact)&&e.params){t=`Params: ${de(e.params)}\n\n`}I.log(`Sending request '${e.method} - (${e.id})'.`,t)}else{ve("send-request",e)}}function pe(e){if(D===p.Off||!I){return}if(z===m.Text){let t=undefined;if(D===p.Verbose||D===p.Compact){if(e.params){t=`Params: ${de(e.params)}\n\n`}else{t="No parameters provided.\n\n"}}I.log(`Sending notification '${e.method}'.`,t)}else{ve("send-notification",e)}}function ge(e,t,r){if(D===p.Off||!I){return}if(z===m.Text){let n=undefined;if(D===p.Verbose||D===p.Compact){if(e.error&&e.error.data){n=`Error data: ${de(e.error.data)}\n\n`}else{if(e.result){n=`Result: ${de(e.result)}\n\n`}else if(e.error===undefined){n="No result returned.\n\n"}}}I.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-r}ms`,n)}else{ve("send-response",e)}}function me(e){if(D===p.Off||!I){return}if(z===m.Text){let t=undefined;if((D===p.Verbose||D===p.Compact)&&e.params){t=`Params: ${de(e.params)}\n\n`}I.log(`Received request '${e.method} - (${e.id})'.`,t)}else{ve("receive-request",e)}}function ye(e){if(D===p.Off||!I||e.method===b.type.method){return}if(z===m.Text){let t=undefined;if(D===p.Verbose||D===p.Compact){if(e.params){t=`Params: ${de(e.params)}\n\n`}else{t="No parameters provided.\n\n"}}I.log(`Received notification '${e.method}'.`,t)}else{ve("receive-notification",e)}}function be(e,t){if(D===p.Off||!I){return}if(z===m.Text){let r=undefined;if(D===p.Verbose||D===p.Compact){if(e.error&&e.error.data){r=`Error data: ${de(e.error.data)}\n\n`}else{if(e.result){r=`Result: ${de(e.result)}\n\n`}else if(e.error===undefined){r="No result returned.\n\n"}}}if(t){const n=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";I.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${n}`,r)}else{I.log(`Received response ${e.id} without active response promise.`,r)}}else{ve("receive-response",e)}}function ve(e,t){if(!I||D===p.Off){return}const r={isLSPMessage:true,type:e,message:t,timestamp:Date.now()};I.log(r)}function _e(){if(ee()){throw new _(v.Closed,"Connection is closed.")}if(te()){throw new _(v.Disposed,"Connection is disposed.")}}function we(){if(Z()){throw new _(v.AlreadyListening,"Connection is already listening")}}function Te(){if(!Z()){throw new Error("Call listen() first.")}}function Ee(e){if(e===undefined){return null}else{return e}}function ke(e){if(e===null){return undefined}else{return e}}function Ce(e){return e!==undefined&&e!==null&&!Array.isArray(e)&&typeof e==="object"}function Re(e,t){switch(e){case s.ParameterStructures.auto:if(Ce(t)){return ke(t)}else{return[Ee(t)]}case s.ParameterStructures.byName:if(!Ce(t)){throw new Error(`Received parameters by name but param is not an object literal.`)}return ke(t);case s.ParameterStructures.byPosition:return[Ee(t)];default:throw new Error(`Unknown parameter structure ${e.toString()}`)}}function Se(e,t){let r;const n=e.numberOfParams;switch(n){case 0:r=undefined;break;case 1:r=Re(e.parameterStructures,t[0]);break;default:r=[];for(let e=0;e<t.length&&e<n;e++){r.push(Ee(t[e]))}if(t.length<n){for(let e=t.length;e<n;e++){r.push(null)}}break}return r}const je={sendNotification:(e,...t)=>{_e();let n;let o;if(i.string(e)){n=e;const r=t[0];let i=0;let a=s.ParameterStructures.auto;if(s.ParameterStructures.is(r)){i=1;a=r}let c=t.length;const u=c-i;switch(u){case 0:o=undefined;break;case 1:o=Re(a,t[i]);break;default:if(a===s.ParameterStructures.byName){throw new Error(`Received ${u} parameters for 'by Name' notification parameter structure.`)}o=t.slice(i,c).map((e=>Ee(e)));break}}else{const r=t;n=e.method;o=Se(e,r)}const a={jsonrpc:S,method:n,params:o};pe(a);return r.write(a).catch((()=>w.error(`Sending notification failed.`)))},onNotification:(e,t)=>{_e();let r;if(i.func(e)){O=e}else if(t){if(i.string(e)){r=e;P.set(e,{type:undefined,handler:t})}else{r=e.method;P.set(e.method,{type:e,handler:t})}}return{dispose:()=>{if(r!==undefined){P.delete(r)}else{O=undefined}}}},onProgress:(e,t,r)=>{if(N.has(t)){throw new Error(`Progress handler for token ${t} already registered`)}N.set(t,r);return{dispose:()=>{N.delete(t)}}},sendProgress:(e,t,r)=>je.sendNotification(l.type,{token:t,value:r}),onUnhandledProgress:V.event,sendRequest:(e,...t)=>{_e();Te();let n;let o;let a=undefined;if(i.string(e)){n=e;const r=t[0];const i=t[t.length-1];let u=0;let f=s.ParameterStructures.auto;if(s.ParameterStructures.is(r)){u=1;f=r}let l=t.length;if(c.CancellationToken.is(i)){l=l-1;a=i}const d=l-u;switch(d){case 0:o=undefined;break;case 1:o=Re(f,t[u]);break;default:if(f===s.ParameterStructures.byName){throw new Error(`Received ${d} parameters for 'by Name' request parameter structure.`)}o=t.slice(u,l).map((e=>Ee(e)));break}}else{const r=t;n=e.method;o=Se(e,r);const i=e.numberOfParams;a=c.CancellationToken.is(r[i])?r[i]:undefined}const u=T++;let f;if(a){f=a.onCancellationRequested((()=>{const e=H.sender.sendCancellation(je,u);if(e===undefined){w.log(`Received no promise from cancellation strategy when cancelling id ${u}`);return Promise.resolve()}else{return e.catch((()=>{w.log(`Sending cancellation messages for id ${u} failed`)}))}}))}const l=new Promise(((e,t)=>{const i={jsonrpc:S,id:u,method:n,params:o};const a=t=>{e(t);H.sender.cleanup(u);f?.dispose()};const c=e=>{t(e);H.sender.cleanup(u);f?.dispose()};let l={method:n,timerStart:Date.now(),resolve:a,reject:c};he(i);try{r.write(i).catch((()=>w.error(`Sending request failed.`)))}catch(d){l.reject(new s.ResponseError(s.ErrorCodes.MessageWriteError,d.message?d.message:"Unknown reason"));l=null}if(l){q.set(u,l)}}));return l},onRequest:(e,t)=>{_e();let r=null;if(h.is(e)){r=undefined;j=e}else if(i.string(e)){r=null;if(t!==undefined){r=e;M.set(e,{handler:t,type:undefined})}}else{if(t!==undefined){r=e.method;M.set(e.method,{type:e,handler:t})}}return{dispose:()=>{if(r===null){return}if(r!==undefined){M.delete(r)}else{j=undefined}}}},hasPendingResponse:()=>q.size>0,trace:async(e,t,r)=>{let n=false;let s=m.Text;if(r!==undefined){if(i.boolean(r)){n=r}else{n=r.sendNotification||false;s=r.traceFormat||m.Text}}D=e;z=s;if(D===p.Off){I=undefined}else{I=t}if(n&&!ee()&&!te()){await je.sendNotification(y.type,{value:p.toString(e)})}},onError:B.event,onClose:F.event,onUnhandledNotification:U.event,onDispose:J.event,end:()=>{r.end()},dispose:()=>{if(te()){return}W=R.Disposed;J.fire(undefined);const t=new s.ResponseError(s.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const e of q.values()){e.reject(t)}q=new Map;A=new Map;$=new Set;L=new o.LinkedMap;if(i.func(r.dispose)){r.dispose()}if(i.func(e.dispose)){e.dispose()}},listen:()=>{_e();we();W=R.Listening;e.listen(ae)},inspect:()=>{(0,n.default)().console.log("inspect")}};je.onNotification(b.type,(e=>{if(D===p.Off||!I){return}const t=D===p.Verbose||D===p.Compact;I.log(e.message,t?e.verbose:undefined)}));je.onNotification(l.type,(e=>{const t=N.get(e.token);if(t){t(e.value)}else{V.fire(e)}}));return je}t.createMessageConnection=S},83911:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Disposable=void 0;var r;(function(e){function t(e){return{dispose:e}}e.create=t})(r=t.Disposable||(t.Disposable={}))},27135:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Emitter=t.Event=void 0;const n=r(30147);var i;(function(e){const t={dispose(){}};e.None=function(){return t}})(i=t.Event||(t.Event={}));class s{add(e,t=null,r){if(!this._callbacks){this._callbacks=[];this._contexts=[]}this._callbacks.push(e);this._contexts.push(t);if(Array.isArray(r)){r.push({dispose:()=>this.remove(e,t)})}}remove(e,t=null){if(!this._callbacks){return}let r=false;for(let n=0,i=this._callbacks.length;n<i;n++){if(this._callbacks[n]===e){if(this._contexts[n]===t){this._callbacks.splice(n,1);this._contexts.splice(n,1);return}else{r=true}}}if(r){throw new Error("When adding a listener with a context, you should remove it with the same context")}}invoke(...e){if(!this._callbacks){return[]}const t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let o=0,a=r.length;o<a;o++){try{t.push(r[o].apply(i[o],e))}catch(s){(0,n.default)().console.error(s)}}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=undefined;this._contexts=undefined}}class o{constructor(e){this._options=e}get event(){if(!this._event){this._event=(e,t,r)=>{if(!this._callbacks){this._callbacks=new s}if(this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()){this._options.onFirstListenerAdd(this)}this._callbacks.add(e,t);const n={dispose:()=>{if(!this._callbacks){return}this._callbacks.remove(e,t);n.dispose=o._noop;if(this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()){this._options.onLastListenerRemove(this)}}};if(Array.isArray(r)){r.push(n)}return n}}return this._event}fire(e){if(this._callbacks){this._callbacks.invoke.call(this._callbacks,e)}}dispose(){if(this._callbacks){this._callbacks.dispose();this._callbacks=undefined}}}t.Emitter=o;o._noop=function(){}},67574:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0;function r(e){return e===true||e===false}t.boolean=r;function n(e){return typeof e==="string"||e instanceof String}t.string=n;function i(e){return typeof e==="number"||e instanceof Number}t.number=i;function s(e){return e instanceof Error}t.error=s;function o(e){return typeof e==="function"}t.func=o;function a(e){return Array.isArray(e)}t.array=a;function c(e){return a(e)&&e.every((e=>n(e)))}t.stringArray=c},96184:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:true});t.LRUCache=t.LinkedMap=t.Touch=void 0;var n;(function(e){e.None=0;e.First=1;e.AsOld=e.First;e.Last=2;e.AsNew=e.Last})(n=t.Touch||(t.Touch={}));class i{constructor(){this[r]="LinkedMap";this._map=new Map;this._head=undefined;this._tail=undefined;this._size=0;this._state=0}clear(){this._map.clear();this._head=undefined;this._tail=undefined;this._size=0;this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=n.None){const r=this._map.get(e);if(!r){return undefined}if(t!==n.None){this.touch(r,t)}return r.value}set(e,t,r=n.None){let i=this._map.get(e);if(i){i.value=t;if(r!==n.None){this.touch(i,r)}}else{i={key:e,value:t,next:undefined,previous:undefined};switch(r){case n.None:this.addItemLast(i);break;case n.First:this.addItemFirst(i);break;case n.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i);this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(!t){return undefined}this._map.delete(e);this.removeItem(t);this._size--;return t.value}shift(){if(!this._head&&!this._tail){return undefined}if(!this._head||!this._tail){throw new Error("Invalid list")}const e=this._head;this._map.delete(e.key);this.removeItem(e);this._size--;return e.value}forEach(e,t){const r=this._state;let n=this._head;while(n){if(t){e.bind(t)(n.value,n.key,this)}else{e(n.value,n.key,this)}if(this._state!==r){throw new Error(`LinkedMap got modified during iteration.`)}n=n.next}}keys(){const e=this._state;let t=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e){throw new Error(`LinkedMap got modified during iteration.`)}if(t){const e={value:t.key,done:false};t=t.next;return e}else{return{value:undefined,done:true}}}};return r}values(){const e=this._state;let t=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e){throw new Error(`LinkedMap got modified during iteration.`)}if(t){const e={value:t.value,done:false};t=t.next;return e}else{return{value:undefined,done:true}}}};return r}entries(){const e=this._state;let t=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e){throw new Error(`LinkedMap got modified during iteration.`)}if(t){const e={value:[t.key,t.value],done:false};t=t.next;return e}else{return{value:undefined,done:true}}}};return r}[(r=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size){return}if(e===0){this.clear();return}let t=this._head;let r=this.size;while(t&&r>e){this._map.delete(t.key);t=t.next;r--}this._head=t;this._size=r;if(t){t.previous=undefined}this._state++}addItemFirst(e){if(!this._head&&!this._tail){this._tail=e}else if(!this._head){throw new Error("Invalid list")}else{e.next=this._head;this._head.previous=e}this._head=e;this._state++}addItemLast(e){if(!this._head&&!this._tail){this._head=e}else if(!this._tail){throw new Error("Invalid list")}else{e.previous=this._tail;this._tail.next=e}this._tail=e;this._state++}removeItem(e){if(e===this._head&&e===this._tail){this._head=undefined;this._tail=undefined}else if(e===this._head){if(!e.next){throw new Error("Invalid list")}e.next.previous=undefined;this._head=e.next}else if(e===this._tail){if(!e.previous){throw new Error("Invalid list")}e.previous.next=undefined;this._tail=e.previous}else{const t=e.next;const r=e.previous;if(!t||!r){throw new Error("Invalid list")}t.previous=r;r.next=t}e.next=undefined;e.previous=undefined;this._state++}touch(e,t){if(!this._head||!this._tail){throw new Error("Invalid list")}if(t!==n.First&&t!==n.Last){return}if(t===n.First){if(e===this._head){return}const t=e.next;const r=e.previous;if(e===this._tail){r.next=undefined;this._tail=r}else{t.previous=r;r.next=t}e.previous=undefined;e.next=this._head;this._head.previous=e;this._head=e;this._state++}else if(t===n.Last){if(e===this._tail){return}const t=e.next;const r=e.previous;if(e===this._head){t.previous=undefined;this._head=t}else{t.previous=r;r.next=t}e.next=undefined;e.previous=this._tail;this._tail.next=e;this._tail=e;this._state++}}toJSON(){const e=[];this.forEach(((t,r)=>{e.push([r,t])}));return e}fromJSON(e){this.clear();for(const[t,r]of e){this.set(t,r)}}}t.LinkedMap=i;class s extends i{constructor(e,t=1){super();this._limit=e;this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e;this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1);this.checkTrim()}get(e,t=n.AsNew){return super.get(e,t)}peek(e){return super.get(e,n.None)}set(e,t){super.set(e,t,n.Last);this.checkTrim();return this}checkTrim(){if(this.size>this._limit){this.trimOld(Math.round(this._limit*this._ratio))}}}t.LRUCache=s},75530:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AbstractMessageBuffer=void 0;const r=13;const n=10;const i="\r\n";class s{constructor(e="utf-8"){this._encoding=e;this._chunks=[];this._totalLength=0}get encoding(){return this._encoding}append(e){const t=typeof e==="string"?this.fromString(e,this._encoding):e;this._chunks.push(t);this._totalLength+=t.byteLength}tryReadHeaders(){if(this._chunks.length===0){return undefined}let e=0;let t=0;let s=0;let o=0;e:while(t<this._chunks.length){const i=this._chunks[t];s=0;t:while(s<i.length){const t=i[s];switch(t){case r:switch(e){case 0:e=1;break;case 2:e=3;break;default:e=0}break;case n:switch(e){case 1:e=2;break;case 3:e=4;s++;break e;default:e=0}break;default:e=0}s++}o+=i.byteLength;t++}if(e!==4){return undefined}const a=this._read(o+s);const c=new Map;const u=this.toString(a,"ascii").split(i);if(u.length<2){return c}for(let r=0;r<u.length-2;r++){const e=u[r];const t=e.indexOf(":");if(t===-1){throw new Error("Message header must separate key and value using :")}const n=e.substr(0,t);const i=e.substr(t+1).trim();c.set(n,i)}return c}tryReadBody(e){if(this._totalLength<e){return undefined}return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0){return this.emptyBuffer()}if(e>this._totalLength){throw new Error(`Cannot read so many bytes!`)}if(this._chunks[0].byteLength===e){const t=this._chunks[0];this._chunks.shift();this._totalLength-=e;return this.asNative(t)}if(this._chunks[0].byteLength>e){const t=this._chunks[0];const r=this.asNative(t,e);this._chunks[0]=t.slice(e);this._totalLength-=e;return r}const t=this.allocNative(e);let r=0;let n=0;while(e>0){const i=this._chunks[n];if(i.byteLength>e){const s=i.slice(0,e);t.set(s,r);r+=e;this._chunks[n]=i.slice(e);this._totalLength-=e;e-=e}else{t.set(i,r);r+=i.byteLength;this._chunks.shift();this._totalLength-=i.byteLength;e-=i.byteLength}}return t}}t.AbstractMessageBuffer=s},56525:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=void 0;const n=r(30147);const i=r(67574);const s=r(27135);var o;(function(e){function t(e){let t=e;return t&&i.func(t.listen)&&i.func(t.dispose)&&i.func(t.onError)&&i.func(t.onClose)&&i.func(t.onPartialMessage)}e.is=t})(o=t.MessageReader||(t.MessageReader={}));class a{constructor(){this.errorEmitter=new s.Emitter;this.closeEmitter=new s.Emitter;this.partialMessageEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose();this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(undefined)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){if(e instanceof Error){return e}else{return new Error(`Reader received error. Reason: ${i.string(e.message)?e.message:"unknown"}`)}}}t.AbstractMessageReader=a;var c;(function(e){function t(e){let t;let r;let i;const s=new Map;let o;const a=new Map;if(e===undefined||typeof e==="string"){t=e??"utf-8"}else{t=e.charset??"utf-8";if(e.contentDecoder!==undefined){i=e.contentDecoder;s.set(i.name,i)}if(e.contentDecoders!==undefined){for(const t of e.contentDecoders){s.set(t.name,t)}}if(e.contentTypeDecoder!==undefined){o=e.contentTypeDecoder;a.set(o.name,o)}if(e.contentTypeDecoders!==undefined){for(const t of e.contentTypeDecoders){a.set(t.name,t)}}}if(o===undefined){o=(0,n.default)().applicationJson.decoder;a.set(o.name,o)}return{charset:t,contentDecoder:i,contentDecoders:s,contentTypeDecoder:o,contentTypeDecoders:a}}e.fromOptions=t})(c||(c={}));class u extends a{constructor(e,t){super();this.readable=e;this.options=c.fromOptions(t);this.buffer=(0,n.default)().messageBuffer.create(this.options.charset);this._partialMessageTimeout=1e4;this.nextMessageLength=-1;this.messageToken=0}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1;this.messageToken=0;this.partialMessageTimer=undefined;this.callback=e;const t=this.readable.onData((e=>{this.onData(e)}));this.readable.onError((e=>this.fireError(e)));this.readable.onClose((()=>this.fireClose()));return t}onData(e){this.buffer.append(e);while(true){if(this.nextMessageLength===-1){const e=this.buffer.tryReadHeaders();if(!e){return}const t=e.get("Content-Length");if(!t){throw new Error("Header must provide a Content-Length property.")}const r=parseInt(t);if(isNaN(r)){throw new Error("Content-Length value must be a number.")}this.nextMessageLength=r}const e=this.buffer.tryReadBody(this.nextMessageLength);if(e===undefined){this.setPartialMessageTimer();return}this.clearPartialMessageTimer();this.nextMessageLength=-1;let t;if(this.options.contentDecoder!==undefined){t=this.options.contentDecoder.decode(e)}else{t=Promise.resolve(e)}t.then((e=>{this.options.contentTypeDecoder.decode(e,this.options).then((e=>{this.callback(e)}),(e=>{this.fireError(e)}))}),(e=>{this.fireError(e)}))}}clearPartialMessageTimer(){if(this.partialMessageTimer){this.partialMessageTimer.dispose();this.partialMessageTimer=undefined}}setPartialMessageTimer(){this.clearPartialMessageTimer();if(this._partialMessageTimeout<=0){return}this.partialMessageTimer=(0,n.default)().timer.setTimeout(((e,t)=>{this.partialMessageTimer=undefined;if(e===this.messageToken){this.firePartialMessage({messageToken:e,waitingTime:t});this.setPartialMessageTimer()}}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout)}}t.ReadableStreamMessageReader=u},96654:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=void 0;const n=r(30147);const i=r(67574);const s=r(80142);const o=r(27135);const a="Content-Length: ";const c="\r\n";var u;(function(e){function t(e){let t=e;return t&&i.func(t.dispose)&&i.func(t.onClose)&&i.func(t.onError)&&i.func(t.write)}e.is=t})(u=t.MessageWriter||(t.MessageWriter={}));class f{constructor(){this.errorEmitter=new o.Emitter;this.closeEmitter=new o.Emitter}dispose(){this.errorEmitter.dispose();this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(undefined)}asError(e){if(e instanceof Error){return e}else{return new Error(`Writer received error. Reason: ${i.string(e.message)?e.message:"unknown"}`)}}}t.AbstractMessageWriter=f;var l;(function(e){function t(e){if(e===undefined||typeof e==="string"){return{charset:e??"utf-8",contentTypeEncoder:(0,n.default)().applicationJson.encoder}}else{return{charset:e.charset??"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:e.contentTypeEncoder??(0,n.default)().applicationJson.encoder}}}e.fromOptions=t})(l||(l={}));class d extends f{constructor(e,t){super();this.writable=e;this.options=l.fromOptions(t);this.errorCount=0;this.writeSemaphore=new s.Semaphore(1);this.writable.onError((e=>this.fireError(e)));this.writable.onClose((()=>this.fireClose()))}async write(e){return this.writeSemaphore.lock((async()=>{const t=this.options.contentTypeEncoder.encode(e,this.options).then((e=>{if(this.options.contentEncoder!==undefined){return this.options.contentEncoder.encode(e)}else{return e}}));return t.then((t=>{const r=[];r.push(a,t.byteLength.toString(),c);r.push(c);return this.doWrite(e,r,t)}),(e=>{this.fireError(e);throw e}))}))}async doWrite(e,t,r){try{await this.writable.write(t.join(""),"ascii");return this.writable.write(r)}catch(n){this.handleError(n,e);return Promise.reject(n)}}handleError(e,t){this.errorCount++;this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}t.WriteableStreamMessageWriter=d},20839:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Message=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType=t.RequestType0=t.AbstractMessageSignature=t.ParameterStructures=t.ResponseError=t.ErrorCodes=void 0;const n=r(67574);var i;(function(e){e.ParseError=-32700;e.InvalidRequest=-32600;e.MethodNotFound=-32601;e.InvalidParams=-32602;e.InternalError=-32603;e.jsonrpcReservedErrorRangeStart=-32099;e.serverErrorStart=-32099;e.MessageWriteError=-32099;e.MessageReadError=-32098;e.PendingResponseRejected=-32097;e.ConnectionInactive=-32096;e.ServerNotInitialized=-32002;e.UnknownErrorCode=-32001;e.jsonrpcReservedErrorRangeEnd=-32e3;e.serverErrorEnd=-32e3})(i=t.ErrorCodes||(t.ErrorCodes={}));class s extends Error{constructor(e,t,r){super(t);this.code=n.number(e)?e:i.UnknownErrorCode;this.data=r;Object.setPrototypeOf(this,s.prototype)}toJson(){const e={code:this.code,message:this.message};if(this.data!==undefined){e.data=this.data}return e}}t.ResponseError=s;class o{constructor(e){this.kind=e}static is(e){return e===o.auto||e===o.byName||e===o.byPosition}toString(){return this.kind}}t.ParameterStructures=o;o.auto=new o("auto");o.byPosition=new o("byPosition");o.byName=new o("byName");class a{constructor(e,t){this.method=e;this.numberOfParams=t}get parameterStructures(){return o.auto}}t.AbstractMessageSignature=a;class c extends a{constructor(e){super(e,0)}}t.RequestType0=c;class u extends a{constructor(e,t=o.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}t.RequestType=u;class f extends a{constructor(e,t=o.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}t.RequestType1=f;class l extends a{constructor(e){super(e,2)}}t.RequestType2=l;class d extends a{constructor(e){super(e,3)}}t.RequestType3=d;class h extends a{constructor(e){super(e,4)}}t.RequestType4=h;class p extends a{constructor(e){super(e,5)}}t.RequestType5=p;class g extends a{constructor(e){super(e,6)}}t.RequestType6=g;class m extends a{constructor(e){super(e,7)}}t.RequestType7=m;class y extends a{constructor(e){super(e,8)}}t.RequestType8=y;class b extends a{constructor(e){super(e,9)}}t.RequestType9=b;class v extends a{constructor(e,t=o.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}t.NotificationType=v;class _ extends a{constructor(e){super(e,0)}}t.NotificationType0=_;class w extends a{constructor(e,t=o.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}t.NotificationType1=w;class T extends a{constructor(e){super(e,2)}}t.NotificationType2=T;class E extends a{constructor(e){super(e,3)}}t.NotificationType3=E;class k extends a{constructor(e){super(e,4)}}t.NotificationType4=k;class C extends a{constructor(e){super(e,5)}}t.NotificationType5=C;class R extends a{constructor(e){super(e,6)}}t.NotificationType6=R;class S extends a{constructor(e){super(e,7)}}t.NotificationType7=S;class j extends a{constructor(e){super(e,8)}}t.NotificationType8=j;class M extends a{constructor(e){super(e,9)}}t.NotificationType9=M;var O;(function(e){function t(e){const t=e;return t&&n.string(t.method)&&(n.string(t.id)||n.number(t.id))}e.isRequest=t;function r(e){const t=e;return t&&n.string(t.method)&&e.id===void 0}e.isNotification=r;function i(e){const t=e;return t&&(t.result!==void 0||!!t.error)&&(n.string(t.id)||n.number(t.id)||t.id===null)}e.isResponse=i})(O=t.Message||(t.Message={}))},30147:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});let r;function n(){if(r===undefined){throw new Error(`No runtime abstraction layer installed`)}return r}(function(e){function t(e){if(e===undefined){throw new Error(`No runtime abstraction layer provided`)}r=e}e.install=t})(n||(n={}));t["default"]=n},80142:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Semaphore=void 0;const n=r(30147);class i{constructor(e=1){if(e<=0){throw new Error("Capacity must be greater than 0")}this._capacity=e;this._active=0;this._waiting=[]}lock(e){return new Promise(((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r});this.runNext()}))}get active(){return this._active}runNext(){if(this._waiting.length===0||this._active===this._capacity){return}(0,n.default)().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(this._waiting.length===0||this._active===this._capacity){return}const e=this._waiting.shift();this._active++;if(this._active>this._capacity){throw new Error(`To many thunks active`)}try{const t=e.thunk();if(t instanceof Promise){t.then((t=>{this._active--;e.resolve(t);this.runNext()}),(t=>{this._active--;e.reject(t);this.runNext()}))}else{this._active--;e.resolve(t);this.runNext()}}catch(t){this._active--;e.reject(t);this.runNext()}}}t.Semaphore=i},97608:(e,t,r)=>{"use strict";r.d(t,{ConsoleLogger:()=>l,listen:()=>d});var n=r(39054);var i=r(20839);class s{constructor(){this.disposables=[]}dispose(){while(this.disposables.length!==0){this.disposables.pop().dispose()}}push(e){const t=this.disposables;t.push(e);return{dispose(){const r=t.indexOf(e);if(r!==-1){t.splice(r,1)}}}}}var o=r(56525);class a extends o.AbstractMessageReader{constructor(e){super();this.socket=e;this.state="initial";this.events=[];this.socket.onMessage((e=>this.readMessage(e)));this.socket.onError((e=>this.fireError(e)));this.socket.onClose(((e,t)=>{if(e!==1e3){const r={name:""+e,message:`Error during socket reconnect: code = ${e}, reason = ${t}`};this.fireError(r)}this.fireClose()}))}listen(e){if(this.state==="initial"){this.state="listening";this.callback=e;while(this.events.length!==0){const e=this.events.pop();if(e.message){this.readMessage(e.message)}else if(e.error){this.fireError(e.error)}else{this.fireClose()}}}return{dispose:()=>{if(this.callback===e){this.callback=undefined}}}}readMessage(e){if(this.state==="initial"){this.events.splice(0,0,{message:e})}else if(this.state==="listening"){const t=JSON.parse(e);this.callback(t)}}fireError(e){if(this.state==="initial"){this.events.splice(0,0,{error:e})}else if(this.state==="listening"){super.fireError(e)}}fireClose(){if(this.state==="initial"){this.events.splice(0,0,{})}else if(this.state==="listening"){super.fireClose()}this.state="closed"}}var c=r(96654);class u extends c.AbstractMessageWriter{constructor(e){super();this.socket=e;this.errorCount=0}end(){}async write(e){try{const t=JSON.stringify(e);this.socket.send(t)}catch(t){this.errorCount++;this.fireError(t,e,this.errorCount)}}}function f(e,t){const r=new a(e);const i=new u(e);const s=(0,n.createMessageConnection)(r,i,t);s.onClose((()=>s.dispose()));return s}class l{error(e){console.error(e)}warn(e){console.warn(e)}info(e){console.info(e)}log(e){console.log(e)}debug(e){console.debug(e)}}function d(e){const{webSocket:t,onConnection:r}=e;const n=e.logger||new l;t.onopen=()=>{const e=h(t);const i=f(e,n);r(i)}}function h(e){return{send:t=>e.send(t),onMessage:t=>{e.onmessage=e=>t(e.data)},onError:t=>{e.onerror=e=>{if("message"in e){t(e.message)}}},onClose:t=>{e.onclose=e=>t(e.code,e.reason)},dispose:()=>e.close()}}}}]);
//# sourceMappingURL=8875.8da7cb48fb402ac6f8a5.js.map?v=8da7cb48fb402ac6f8a5